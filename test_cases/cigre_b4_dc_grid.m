%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%                                                                  			 	  %%%%%
%%%%    IEEE PES Power Grid Library - Optimal Power Flow with HVDC Lines - vXX.XX     %%%%%
%%%%          (https://github.com/power-grid-lib/pglib-opf-hvdc)      				  %%%%%
%%%%               Benchmark Group - Typical Operations               				  %%%%%
%%%%                         DD - Month - YYY                       				  %%%%%
%%%%                                                                  				  %%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   AC/DC grid OPF test case based on: CIGRÉ 
%
%   Transcribed by Oscar Damanik (oscar.damanik@kuleuven.be) from [1]
%	- Assumptions on the converter parameters will be provided	
%
%	References:
%	[1] T. K. Vrana, Y. Yang, D. Jovcic, S. Dennetière, J. Hardini, and H. Saad,
%	“The CIGRE B4 DC Grid Test System,” vol. 270, pp. 10–19, Oct. 2013.
%
% 
%   Copyright (c) 2023 
%   Licensed under the Creative Commons Attribution 4.0
%   International license, http://creativecommons.org/licenses/by/4.0/
%

function mpc = cigreb4dc
mpc.version = '2';
mpc.baseMVA = 100.0;
mpc.variant = 'base'

%% bus data
%	bus_i	type		Pd		Qd		  Gs	 Bs	   area		Vm	   Va		   baseKV	zone	  Vmax			 Vmin
mpc.bus = [
1	3	0	0	0	0	1	1	0	380	1	1.1	0.9	;
2	2	1000	0	0	0	1	1	0	380	1	1.1	0.9	;
3	3	0	0	0	0	1	1	0	380	1	1.1	0.9	;
4	2	2200	0	0	0	1	1	0	380	1	1.1	0.9	;
5	2	2300	0	0	0	1	1	0	380	1	1.1	0.9	;
6	2	1900	0	0	0	1	1	0	380	1	1.1	0.9	;
7	2	0	0	0	0	1	1	0	380	1	1.1	0.9	;
8	2	0	0	0	0	1	1	0	380	1	1.1	0.9	;
9	2	0	0	0	0	1	1	0	380	1	1.1	0.9	;
10	2	100	0	0	0	1	1	0	380	1	1.1	0.9	;
11	2	0	0	0	0	1	1	0	380	1	1.1	0.9	;
];

%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf	alpha
mpc.gen = [
2	2000	0	720	0	1.05	100	1	4000	0	0	0	0	0	0	0	0	0	0	0	0	1	;
4	1000	0	360	0	1.05	100	1	2000	0	0	0	0	0	0	0	0	0	0	0	0	1	;
5	1000	0	360	0	1.05	100	1	2000	0	0	0	0	0	0	0	0	0	0	0	0	1	;
6	1000	0	360	0	1.05	100	1	2000	0	0	0	0	0	0	0	0	0	0	0	0	1	;
7	500	0	180	0	1.05	100	1	500	0	0	0	0	0	0	0	0	0	0	0	0	1	;
8	500	0	180	0	1.05	100	1	500	0	0	0	0	0	0	0	0	0	0	0	0	1	;
9	1000	0	360	0	1.05	100	1	1000	0	0	0	0	0	0	0	0	0	0	0	0	1	;
11	500	0	180	0	1.05	100	1	500	0	0	0	0	0	0	0	0	0	0	0	0	1	;
];

%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax	imax
mpc.branch = [
1	2	0.002770083	0.037124749	0.612422072	2339.827436	2339.827436	2339.827436	0	0	1	-30	30	3555	;
1	2	0.002770083	0.037124749	0.612422072	2339.827436	2339.827436	2339.827436	0	0	1	-30	30	3555	;
3	4	0.002770083	0.037124749	0.612422072	2339.827436	2339.827436	2339.827436	0	0	1	-30	30	3555	;
3	5	0.002770083	0.037124749	0.612422072	2339.827436	2339.827436	2339.827436	0	0	1	-30	30	3555	;
3	6	0.002770083	0.037124749	0.612422072	2339.827436	2339.827436	2339.827436	0	0	1	-30	30	3555	;
4	6	0.002770083	0.037124749	0.612422072	2339.827436	2339.827436	2339.827436	0	0	1	-30	30	3555	;
5	6	0.002770083	0.037124749	0.612422072	2339.827436	2339.827436	2339.827436	0	0	1	-30	30	3555	;
7	8	0.020047562	0.018871969	0.303343744	179.5703675	179.5703675	179.5703675	0	0	1	-30	30	715	;
];

%% dc grid topology
%column_names% dcpoles
mpc.dcpol=2;
% numbers of poles (1=monopolar grid, 2=bipolar grid)
%% bus data
%column_names%  busdc_i    grid    Pdc     Vdc   basekVdc    Vdcmax   Vdcmin   Cdc  area
mpc.busdc = [
1	1	0	1	200	1.1	0.9	0	1	;
2	1	0	1	200	1.1	0.9	0	1	;
3	1	0	1	400	1.1	0.9	0	1	;
4	1	0	1	400	1.1	0.9	0	1	;
5	1	0	1	400	1.1	0.9	0	1	;
6	1	0	1	400	1.1	0.9	0	1	;
7	1	0	1	400	1.1	0.9	0	1	;
8	1	0	1	400	1.1	0.9	0	1	;
9	1	0	1	400	1.1	0.9	0	1	;
10	1	0	1	400	1.1	0.9	0	1	;
11	1	0	1	200	1.1	0.9	0	1	;
12	1	0	1	200	1.1	0.9	0	1	;
13	1	0	1	200	1.1	0.9	0	1	;
14	1	0	1	200	1.1	0.9	0	1	;
15	1	0	1	200	1.1	0.9	0	1	;
];

%% converters
%column_names%  busdc_i	busac_i	type_dc	type_ac	P_g	Q_g	islcc	Vtar	rtf	xtf	transformer	tm	bf	filter	rc	xc	reactor	basekVac	Vmmax	Vmmin	Imax	status	LossA	LossB	LossCrec	LossCinv	droop	Pdcset	Vdcset	dVdcset	Pacmax	Pacmin	Qacmax	Qacmin	ratio	index	Pacrated	Qacrated	conv_id	type_link control_pdc control_vdc control_vdc_mode
mpc.convdc = [
1	2	1	1	800	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	380	1.1	0.9	1215.474251	1	1.103	0.887	2.885	2.885	0.005	800	1	0	800	-800	800	-800	0	1	800	800	1	2	0	1	3;
2	7	1	1	800	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	145	1.1	0.9	3185.380796	1	1.103	0.887	2.885	2.885	0.005	800	1	0	800	-800	800	-800	0	2	800	800	2	2	1	0	2;
11	5	1	1	800	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	380	1.1	0.9	1215.474251	1	1.103	0.887	2.885	2.885	10	800	1	0	800	-800	800	-800	0	3	800	800	3	2	1	1	1;
12	6	1	1	1200	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	380	1.1	0.9	1823.211376	1	1.103	0.887	2.885	2.885	10	1200	1	0	1200	-1200	1200	-1200	0	4	1200	1200	4	2	1	1	1;
14	10	1	1	200	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	145	1.1	0.9	796.3451989	1	1.103	0.887	2.885	2.885	0.005	200	1	0	200	-200	200	-200	0	5	200	200	5	2	1	0	2;
15	11	1	1	800	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	145	1.1	0.9	3185.380796	1	1.103	0.887	2.885	2.885	0.005	800	1	0	800	-800	800	-800	0	6	800	800	6	2	1	0	2;
3	2	1	1	2400	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	380	1.1	0.9	3646.422753	1	1.103	0.887	2.885	2.885	10	2400	1	0	2400	-2400	2400	-2400	0	7	2400	2400	7	2	1	1	1;
7	4	1	1	2400	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	380	1.1	0.9	3646.422753	1	1.103	0.887	2.885	2.885	10	2400	1	0	2400	-2400	2400	-2400	0	8	2400	2400	8	2	1	1	1;
10	5	1	1	2400	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	145	1.1	0.9	9556.142387	1	1.103	0.887	2.885	2.885	10	2400	1	0	2400	-2400	2400	-2400	0	9	2400	2400	9	2	1	1	1;
4	8	1	1	800	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	380	1.1	0.9	1215.474251	1	1.103	0.887	2.885	2.885	0.005	800	1	0	800	-800	800	-800	0	10	800	800	10	2	1	0	2;
5	9	1	1	1600	0	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	145	1.1	0.9	6370.761591	1	1.103	0.887	2.885	2.885	0.005	1600	1	0	1600	-1600	1600	-1600	0	11	1600	1600	11	2	1	0	2;
];

%% dc branches
%column_names%  fbusdc  tbusdc  r        l   c   rateA   rateB   rateC   status dcpoles
mpc.branchdc = [
1	2	0.00475	0	0	392.4	392.4	392.4	1	1	;
3	4	0.00475	0	0	453	453	453	1	2	;
3	6	0.01425	0	0	700	700	700	1	2	;
3	7	0.0114	0	0	700	700	700	1	2	;
3	7	0.0114	0	0	700	700	700	1	2	;
4	5	0.007125	0	0	453	453	453	1	2	;
6	7	0.0057	0	0	700	700	700	1	2	;
8	9	0.00475	0	0	453	453	453	1	2	;
5	9	0.00475	0	0	453	453	453	1	2	;
6	10	0.007125	0	0	453	453	453	1	2	;
6	10	0.007125	0	0	453	453	453	1	2	;
11	12	0.00475	0	0	392.4	392.4	392.4	1	1	;
12	13	0.002375	0	0	392.4	392.4	392.4	1	1	;
13	15	0.002375	0	0	392.4	392.4	392.4	1	1	;
14	15	0.00475	0	0	392.4	392.4	392.4	1	1	;
7	8	0.00012	0	0	2000	2000	2000	1	1	;
9	14	0.00012	0	0	1000	1000	1000	1	1	;
];

%% generator cost data
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	0	0	2	50	0;
	2	0	0	2	50	0;
	2	0	0	2	50	0;
	2	0	0	2	50	0;
	2	0	0	2	0	0;
	2	0	0	2	0	0;
	2	0	0	2	0	0;
	2	0	0	2	0	0;
];

%% generator data
%column_names%	type
mpc.othergen = [
1	;
1	;
1	;
1	;
2	;
2	;
2	;
2	;
];